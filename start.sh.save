#!/bin/bash

# Load environment variables
set -a
source .env
set +a

# Generate nginx.conf from template
envsubst '${PORT}' < nginx.conf.template > nginx.conf

echo "‚úÖ Configuration generated"
echo "üì¶ Starting services..."

# Start all services
docker compose up -d

echo "‚è≥ Waiting for services to be healthy..."
sleep 10

echo "‚úÖ Services started!"
echo ""
echo "üìç Endpoints:"
echo "   Main (Nginx):  http://localhost:${NGINX_PORT}"
echo "   Blue direct:   http://localhost:${BLUE_PORT}"
echo "   Green direct:  http://localhost:${GREEN_PORT}"
echo ""
echo "Test with: curl http://localhost:${NGINX_PORT}/version"
